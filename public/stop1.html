<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Media Source Example</title>
</head>
<body>
    <video id="videoElement" controls width="600"></video>
    <script>
        // Check for Media Source Extensions support
        if ('MediaSource' in window && MediaSource.isTypeSupported('video/webm; codecs="vp8, vorbis"')) {
            var video = document.getElementById('videoElement');
            var mediaSource = new MediaSource();

            video.src = URL.createObjectURL(mediaSource);

            mediaSource.addEventListener('sourceopen', function () {
                var sourceBuffer = mediaSource.addSourceBuffer('video/webm; codecs="vp8, vorbis"');
                
                // Example ArrayBuffer containing WebM data
                // Normally, you'd fetch this from a server
                var videoData = new Uint8Array([
                    0x1A, 0x45, 0xDF, 0xA3, 0x93, 0x42, 0x86, 0x81, 0x01, 0x42, 0xF7, 0x81, 0x01, 0x42, 0xF2, 0x81,
                    0x04, 0x42, 0xF3, 0x81, 0x08, 0x42, 0x82, 0x88, 0x6D, 0x61, 0x74, 0x72, 0x6F, 0x73, 0x6B, 0x61,
                    0x42, 0x87, 0x81, 0x04, 0x42, 0x85, 0x81, 0x02, 0x18, 0x53, 0x80, 0x67, 0x01, 0xFF, 0xFF, 0xFF,
                    0xFF, 0xFF, 0xFF, 0xFF, 0x10, 0x16, 0x54, 0xAE, 0x6B, 0xA3, 0xD9, 0x01, 0x00, 0x00, 0x00, 0x00,
                    0x01, 0x00, 0x00, 0x00, 0x2A, 0xD7, 0x81, 0x01, 0x73, 0xC5, 0x86, 0x80, 0x00, 0x00, 0x1F, 0x42,
                    0xF7, 0xB5, 0x81, 0x00, 0x41, 0x89, 0x16, 0x54, 0xAE, 0x6B, 0xB3, 0xD9, 0x01, 0x00, 0x00, 0x00,
                    0x00, 0x01, 0x00, 0x00, 0x00, 0x2A, 0xD7, 0x81, 0x01, 0x73, 0xC5, 0x86, 0x80, 0x00, 0x00, 0x1F,
                    0x42, 0xF7, 0xB5, 0x81, 0x00, 0x41, 0x89, 0x16, 0x54, 0xAE, 0x6B, 0xA3, 0xD9, 0x01, 0x00, 0x00,
                    0x00, 0x00, 0x01, 0x00, 0x00, 0x00, 0x2A, 0xD7, 0x81, 0x01, 0x73, 0xC5, 0x86, 0x80, 0x00, 0x00,
                    0x1F, 0x42, 0xF7, 0xB5, 0x81, 0x00, 0x41, 0x89, 0x81, 0x01, 0x73, 0xC5, 0x86, 0x80, 0x00, 0x00,
                    0xF7, 0xB5, 0x81, 0x00, 0x41, 0x89, 0x16, 0x54, 0xAE, 0x6B, 0xB3, 0xD9, 0x01, 0x00, 0x00, 0x00,
                    0x00, 0x01, 0x00, 0x00, 0x00, 0x2A, 0xD7, 0x81, 0x01, 0x73, 0xC5, 0x86, 0x80, 0x00, 0x00, 0x1F,
                    0x42, 0xF7, 0xB5, 0x81, 0x00, 0x41, 0x89, 0x16, 0x54, 0xAE, 0x6B, 0xA3, 0xD9, 0x01, 0x00, 0x00,
                    0x00, 0x00, 0x01, 0x00, 0x00, 0x00, 0x2A, 0xD7, 0x81, 0x01, 0x73, 0xC5, 0x86, 0x80, 0x00, 0x00,
                    0x1F, 0x42, 0xF7, 0xB5, 0x81, 0x00, 0x41, 0x89, 0x81, 0x01, 0x73, 0xC5, 0x86, 0x80, 0x00, 0x00,
                    0xF7, 0xB5, 0x81, 0x00, 0x41, 0x89, 0x16, 0x54, 0xAE, 0x6B, 0xB3, 0xD9, 0x01, 0x00, 0x00, 0x00,
                    0x00, 0x01, 0x00, 0x00, 0x00, 0x2A, 0xD7, 0x81, 0x01, 0x73, 0xC5, 0x86, 0x80, 0x00, 0x00, 0x1F,
                    0x42, 0xF7, 0xB5, 0x81, 0x00, 0x41, 0x89, 0x16, 0x54, 0xAE, 0x6B, 0xA3, 0xD9, 0x01, 0x00, 0x00,
                    0x00, 0x00, 0x01, 0x00, 0x00, 0x00, 0x2A, 0xD7, 0x81, 0x01, 0x73, 0xC5, 0x86, 0x80, 0x00, 0x00,
                    0x1F, 0x42, 0xF7, 0xB5, 0x81, 0x00, 0x41, 0x89, 0x81, 0x01, 0x73, 0xC5, 0x86, 0x80, 0x00, 0x00,
                ]);

                sourceBuffer.addEventListener('updateend', function () {
                    if (mediaSource.readyState === 'open') {
                        mediaSource.endOfStream();
                        video.play();
                    }
                });

                sourceBuffer.appendBuffer(videoData);
            });
        } else {
            console.error('Media Source Extensions not supported.');
        }
    </script>
</body>
</html>
